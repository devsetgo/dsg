<!DOCTYPE html>
<html lang="en_US">
<head>
    <meta charset="utf-8" />
    <title>Python FastAPI Library | DevSetGo</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta name="author" content="Mike Ryan">
    <meta name="dc.copyright" content="Mike Ryan">
    <meta name="description" content="Just my site...">
    <meta name="keywords" content="Python, Code, Development, JavaScript, BPMN, Workflow, Camunda, Go">

    
    <link href="https://devsetgo.com/css/bootswatch/hoff.min.css" rel="stylesheet">
    
    <link href="https://devsetgo.com/css/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://devsetgo.com/css/custom.css" rel="stylesheet">



<script type="text/javascript">
    var azbalacHeaderImage = [{"url":"https:\/\/devsetgo.com\/..\/images\/cliffs.jpg",
    "height": '673',
    "width": '2512'},"","",""];
</script>
<script src="https://devsetgo.com/js/jquery-3.3.1.min.js"></script>
<script src="https://devsetgo.com/js/functions.js"></script><style>body {}.footer-container { background-color: #29281f; }.footer-container { color: #f9fcf9; }</style>



<link id="typography-header-title-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Exo%3A800"><style id="typography-title" type="text/css">#site-header-text a {
        font-family: Exo;
    }#site-header-text a {
        font-size: 50px; 
    }</style>

<link id="typography-header-subtitle-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Exo%3A600"><style id="typography-subtitle" type="text/css">#site-description {
        font-family: Exo;
    }#site-description {
        font-size: 30px; 
    }</style>

<style id="typography-body" type="text/css"></style>

<style id="typography-navbar" type="text/css">nav#navbarMain {
        font-size: 20px; 
    }
    nav#navbarMain ul.dropdown-menu {
        font-size: 20px;
    }</style>

<link id="typography-headline-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans"><style id="typography-headline" type="text/css">h1, h2, h3, h4, h5, h6 {
                font-family: Open Sans; 
            }</style>



    
    <script type="text/javascript">
        var azbalacSettingHeaderColor = { 'bg': '#000000',
            'transp': '0'
            };

    </script>
    <style type="text/css">
        #site-header-text a, #site-description {
                background: "#000000";  
            background:  rgba(0,0,0,0.00);
            
        }
    </style>
    
    
    <style type="text/css">
        #site-header-box-title {
            margin-bottom: 0px;
        }
    </style>
    
    
    <style type="text/css">
        #site-header-container-overlay {
        
            left: 20px;
        
        
            top: 20px;
        
        }
    </style>
    


<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

</head>


<body>

<div id="header" role="banner" style="">

    <div class="container">
        <header class="masthead">
            <div>
                <div id="site-header-container-above" class="row align-items-center">
                    
                </div>
            </div>


            

            <div id="site-header-above"><a href="https://devsetgo.com/" rel="home"><img id="site-header-image" src="https://devsetgo.com/../images/cliffs.jpg" width="1" height="1" data-width="2512" data-height="673" alt="alt text for header image">
                </a>

                <div id="site-header-container-overlay" class="position-absolute  fixed-top ">
                    <div id="site-header-box-title" class=" d-flex justify-content-start ">
                        <h1 class="azbalac-title" id="site-header-text"><a class="header-url" style="color: #073642;" href="https://devsetgo.com/">DevSetGo</a></h1>
                    </div>
                    
                </div>
                
             
            </div>


    <nav id="navbarMain" class="navbar navbar-expand-sm justify-content-between mb-3 navbar-dark bg-primary" role="navigation">
        
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
        </button>
      
            
            <div class="sticky-top navbar-collapse collapse  " id="navbarSupportedContent"> 
                <ul class="navbar-nav">

  
  <li class="nav-item ">
    <a class="nav-link" href="/">
      
      Home
    </a>
  </li>
  <span class="mx-2"></span>
  

  
  <li class="nav-item ">
    <a class="nav-link" href="/posts/">
      
      Blog
    </a>
  </li>
  <span class="mx-2"></span>
  

  
  <li class="nav-item ">
    <a class="nav-link" href="/about/">
      
      About
    </a>
  </li>
  <span class="mx-2"></span>
  

  
  <li class="nav-item ">
    <a class="nav-link" href="/projects/">
      
      Projects
    </a>
  </li>
  <span class="mx-2"></span>
  
</ul>
             
            </div>
        
            
    </nav> 



      </header>
    </div> 
</div>


    <div id="main">
        <div class="container">
            <div class="row"><div class="col-md" id="content">





<h1>Python FastAPI Library</h1>

    <div class="post-meta"><span class="byline-icon fa fa-clock-o" aria-hidden="true"></span> <span class="screen-reader-text">Date: </span><time datetime="2019-04-20T12:00:00Z">2019.04.20</time> - 
    <span class="byline-icon fa fa-user" aria-hidden="true"></span><span class="screen-reader-text">Author: </span> Mike  - 
    600 Words </div>


  <figure>
    <img src="/images/fastapi.png"
         alt="FastAPI" width="600"/> 
</figure>

<p>Over the last few months I have been learning Python's <a href="https://docs.python.org/3/library/asyncio.html">Asyncio</a> library. It came from a need at work. I needed to pull a large about of data from Sonarqube. The data is broke into pages of 500 issues each and it required about 50 calls to retrieve all the issues. Using Requests this took about 8-10 minutes via synchronous calls. Each page load being 4-8 seconds and the data processing at the end (about 10 seconds). Frankly, I wasn't expecting this long time to get the data back and decided it was a perfect use for Asyncio.</p>
<figure>
    <img src="/images/async/asyncVsync.png"
         alt="Asyncio" width="600"/> 
</figure>

<p>I find it difficult to explain Asynchronous vs Synchronous programming. Simplest explanation is that the program drops everything into a loop and while it waits for the response it can do &ldquo;something else&rdquo;. Like make another call or work on the response. <a href="https://blog.michaelckennedy.net/">Michael Kennedy</a> has some great <a href="https://blog.jetbrains.com/pycharm/2019/02/webinar-recording-demystifying-pythons-async-and-await-keywords-with-michael-kennedy/">tutorials</a> on this topic, I suggest <a href="https://training.talkpython.fm/courses/explore_async_python/async-in-python-with-threading-and-multiprocessing">reviewing his courses</a>.</p>
<p>I played with several Async frameworks and also tried writting basic &ldquo;async&rdquo; and &ldquo;await&rdquo; functions to get better at the concept. I my main goal was an API builder and &ldquo;if&rdquo; possible also build frontend sites with it.</p>
<ul>
<li><strong><a href="http://flask.pocoo.org/docs/1.0/patterns/celery/">Flask with Celery</a></strong>: Not actually an async framework, but a way to run on another thread. I found this really cool, but a lot of overhead with needing RabbitMQ or Redis.</li>
<li><strong><a href="https://gitlab.com/pgjones/quart">Quart</a></strong>: This is a great idea. Flask that is Async, but not all of Flask is there. There are a lot of issues with existing libraries. Flask-RestPlus doesn't work with it. I hope this becomes Flask Async&hellip; it has great promise.</li>
<li><strong><a href="https://aiohttp.readthedocs.io/en/stable/">Aiohttp</a></strong>: This is how I solved the sonarqube report data issue at work. I find it harder to get into, but the client side was easiest.</li>
<li><strong><a href="https://sanicframework.org/">Sanic</a></strong>: This is interesting, but I am less focused on &ldquo;pure speed&rdquo; and more on ability to build out an API or application. It has good documentation, but I just never really got into Sanic.</li>
<li><strong><a href="https://fastapi.tiangolo.com/">FastAPI</a></strong>: I stumbled on this while looking at <a href="https://github.com/encode/starlette">Starlette</a>/<a href="https://github.com/kennethreitz/responder">Responder</a>. I found it to be easy to get into, easy to learn, and really quick to build out basic APIs. Since it is built over Starlette I can still build a frontend and stay within a single framework (starlette).</li>
</ul>
<p>Over the last few weeks, I have been learning FastAPI and building a test api to simulate long waits. Just like my original problem above. I took inspiration from <a href="http://www.fakeresponse.com/">FakeResponse.com</a> and would like to build the test api out more to fit more of my needs. You can find more information at the page for the <a href="https://devsetgo.com/projects/test-api/">Test API</a> project.</p>
<p>As a note, I seem to hit a maximum threshold of ~2100 calls per second with Async on my notebook. I think this may be a limit of Python on a single thread. SSL on tends to reduce this by about 50% as the extra hope to confirm the cert. Running the benchmarks via <a href="https://github.com/wg/wrk">WRK</a> I am getting about 500 requests per second. I still need to work on performance and it is using a SQLite db, so I think it is reasonable.</p>
<p>I used this <a href="https://medium.com/pharos-production/how-to-benchmark-http-latency-with-wrk-a-z-guide-e5b185bd4cdc">tutorial for WRK</a> and I ran the command as below (please don't use my server for your tests, just pull the docker image and run it on your server) and it worked.</p>
<pre><code>docker run --rm williamyeh/wrk -t2 -c5 -d5s https://test-api.devsetgo.com/api/v1/todo/list/count --timeout 2s
</code></pre><h5 id="sln"><strong>Slán</strong></h5>


                </div>
                    <aside class="col-md-3 tikva-sidebar">
  


    

        <div class="col">
    <!-- raw HTML omitted -->

</div>


    

</aside>
</div>
        </div>
    </div>

    
        <div class="footer-container" style="">
    <div class="container">
        <footer>

            <div class="row">
            
            
                
                    <div class="col">
    <div class="text-center">
    <a href="https://twitter.com/stuxstu" target="_blank" title="Twitter"><i class="fab fa-lg fa-twitter"></i></a>
    <a href="https://github.com/devsetgo/" target="_blank" title="Github"><i class="fab fa-lg fa-github"></i></a>
</div>
</div>
                
                    <div class="col">
    <div>
    <span>
        Copyright © <a href="http://DevSetGo.com" target="_blank">DevSetGo.com</a> 2010 -
        <script>
            var CurrentYear = new Date().getFullYear()
            document.write(CurrentYear)
        </script>
    </span>
</div>
</div>
                
                    <div class="col">
    <div class="text-center">
        Built with
        <a href="https://gohugo.io/" target="_blank" title="Hugo static site generator"><i class="fas fa-lg fa-code"></i></a>
        <a href="https://www.docker.com/" target="_blank" title="Docker"><i class="fab fa-lg fa-docker"></i></a>
        <a href="https://www.javascript.com/" target="_blank" title="JavaScript"><i class="fab fa-lg fa-js"></i></a>
        <a href="https://fontawesome.com" target="_blank" title="Font Awesome"><i class="fab fa-lg fa-font-awesome"></i></a>
        and hosted on <a href="https://m.do.co/c/9a3b3c4fbc90" target="_blank" title="Digital Ocean"><i class="fab fa-lg fa-digital-ocean"></i></a>
</div>
</div>
                
            

            </div>
        </footer>
    </div>
</div>
    
    
        
<div class="subfooter-container">

    <div class="container">
        <div class="footer">
            <div class="row wrapper padding">
                <div class="col-xs-12 col-md-12">

            
            
                
                        

                
            
                  
                </div>
            </div>
        </div>
    </div>
</div>

    

    <div id="media-width-detection-element"></div>
<script src="https://devsetgo.com/js/popper.js"></script>
<script src="https://devsetgo.com/js/bootstrap.min.js"></script>


</body>
</html>